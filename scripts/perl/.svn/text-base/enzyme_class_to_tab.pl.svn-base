#! usr/local/bin/perl
use strict;
use Encode;
use utf8;
use Unicode::String;
use DBI();

#mysql -u jgoll -pstevevai --host=mysql51-lan-dev --local-infile -e "load data local infile 'enzyme.parsed' into table ec (acc,name)" ifx_metagenomics_reports

my $annotationFile		= $ARGV[0];

open FILE, $annotationFile or die ("could not find $annotationFile");

my ($id,$def);


while(<FILE>) {				
		chomp;	
		
		my $level='';
		my $parent ='';
		my $name ='';
				
		my $line = $_;
		my ($id,$name) =split("   ",$_);
		
		#print "$id | $name1\n";
		#my ($id,$name2) =split("    ",$_);
		
		my ($l0,$l1,$l2,$l3) =split("\\.",$id);
		
		
		$l0 = &trim($l0);
		$l1 = &trim($l1);
		$l2 = &trim($l2);
		$l3 = &trim($l3);
		
		if( $l3 eq '-'){
			$level = 'level 3';
			$parent = "$l0.$l1.-.-";
			#$name=$name2
		}
		if( $l2 eq '-'){
			$level = 'level 2';
			$parent = "$l0.-.-.-";
			#$name=$name2
			
		}	
		if( $l1 eq '-'){
			$level = 'level 1';
			$parent = "$l0.$l1.$l2.$l3";
			#$name=$name1
		}	
		
		$name = &trim($name);	
		print "$l0.$l1.$l2.$l3\t$parent\t$level\t$name\t1\n";
		#die();

}

close FILE;

sub trim($)
{
	my $string = shift;
	$string =~ s/^\s+//;
	$string =~ s/\s+$//;
	return $string;
}



